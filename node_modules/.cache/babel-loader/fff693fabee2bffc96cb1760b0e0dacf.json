{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.supportsZeroByteGCM = exports.supportsSubtleCrypto = exports.supportsSecureRandom = exports.supportsWebCrypto = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar subtleCryptoMethods = [\"decrypt\", \"digest\", \"encrypt\", \"exportKey\", \"generateKey\", \"importKey\", \"sign\", \"verify\"];\n\nfunction supportsWebCrypto(window) {\n  if (supportsSecureRandom(window) && typeof window.crypto.subtle === \"object\") {\n    var subtle = window.crypto.subtle;\n    return supportsSubtleCrypto(subtle);\n  }\n\n  return false;\n}\n\nexports.supportsWebCrypto = supportsWebCrypto;\n\nfunction supportsSecureRandom(window) {\n  if (typeof window === \"object\" && typeof window.crypto === \"object\") {\n    var getRandomValues = window.crypto.getRandomValues;\n    return typeof getRandomValues === \"function\";\n  }\n\n  return false;\n}\n\nexports.supportsSecureRandom = supportsSecureRandom;\n\nfunction supportsSubtleCrypto(subtle) {\n  return subtle && subtleCryptoMethods.every(function (methodName) {\n    return typeof subtle[methodName] === \"function\";\n  });\n}\n\nexports.supportsSubtleCrypto = supportsSubtleCrypto;\n\nfunction supportsZeroByteGCM(subtle) {\n  return tslib_1.__awaiter(this, void 0, void 0, function () {\n    var key, zeroByteAuthTag, _a;\n\n    return tslib_1.__generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (!supportsSubtleCrypto(subtle)) return [2\n          /*return*/\n          , false];\n          _b.label = 1;\n\n        case 1:\n          _b.trys.push([1, 4,, 5]);\n\n          return [4\n          /*yield*/\n          , subtle.generateKey({\n            name: \"AES-GCM\",\n            length: 128\n          }, false, [\"encrypt\"])];\n\n        case 2:\n          key = _b.sent();\n          return [4\n          /*yield*/\n          , subtle.encrypt({\n            name: \"AES-GCM\",\n            iv: new Uint8Array(Array(12)),\n            additionalData: new Uint8Array(Array(16)),\n            tagLength: 128\n          }, key, new Uint8Array(0))];\n\n        case 3:\n          zeroByteAuthTag = _b.sent();\n          return [2\n          /*return*/\n          , zeroByteAuthTag.byteLength === 16];\n\n        case 4:\n          _a = _b.sent();\n          return [2\n          /*return*/\n          , false];\n\n        case 5:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nexports.supportsZeroByteGCM = supportsZeroByteGCM;","map":{"version":3,"mappings":";;;;;;;;;AAUA,IAAMA,mBAAmB,GAA8B,CACrD,SADqD,EAErD,QAFqD,EAGrD,SAHqD,EAIrD,WAJqD,EAKrD,aALqD,EAMrD,WANqD,EAOrD,MAPqD,EAQrD,QARqD,CAAvD;;AAWA,SAAgBC,iBAAhB,CAAkCC,MAAlC,EAAgD;AAC9C,MACEC,oBAAoB,CAACD,MAAD,CAApB,IACA,OAAOA,MAAM,CAACE,MAAP,CAAcC,MAArB,KAAgC,QAFlC,EAGE;AACQ,cAAM,GAAKH,MAAM,CAACE,MAAP,CAAaC,MAAxB;AAER,WAAOC,oBAAoB,CAACD,MAAD,CAA3B;AACD;;AAED,SAAO,KAAP;AACD;;AAXDE;;AAaA,SAAgBJ,oBAAhB,CAAqCD,MAArC,EAAmD;AACjD,MAAI,OAAOA,MAAP,KAAkB,QAAlB,IAA8B,OAAOA,MAAM,CAACE,MAAd,KAAyB,QAA3D,EAAqE;AAC3D,uBAAe,GAAKF,MAAM,CAACE,MAAP,CAAaI,eAAjC;AAER,WAAO,OAAOA,eAAP,KAA2B,UAAlC;AACD;;AAED,SAAO,KAAP;AACD;;AARDD;;AAUA,SAAgBD,oBAAhB,CAAqCD,MAArC,EAAyD;AACvD,SACEA,MAAM,IACNL,mBAAmB,CAACS,KAApB,CACE,sBAAU;AAAI,kBAAOJ,MAAM,CAACK,UAAD,CAAb,KAA8B,UAA9B;AAAwC,GADxD,CAFF;AAMD;;AAPDH;;AASA,SAAsBI,mBAAtB,CAA0CN,MAA1C,EAA8D;;;;;;;AAC5D,cAAI,CAACC,oBAAoB,CAACD,MAAD,CAAzB,EAAmC;AAAA;AAAA,YAAO,KAAP;;;;;;AAErB;AAAA;AAAA,YAAMA,MAAM,CAACO,WAAP,CAChB;AAAEC,gBAAI,EAAE,SAAR;AAAmBC,kBAAM,EAAE;AAA3B,WADgB,EAEhB,KAFgB,EAGhB,CAAC,SAAD,CAHgB,CAAN;;;AAANC,aAAG,GAAGC,SAAN;AAKkB;AAAA;AAAA,YAAMX,MAAM,CAACY,OAAP,CAC5B;AACEJ,gBAAI,EAAE,SADR;AAEEK,cAAE,EAAE,IAAIC,UAAJ,CAAeC,KAAK,CAAC,EAAD,CAApB,CAFN;AAGEC,0BAAc,EAAE,IAAIF,UAAJ,CAAeC,KAAK,CAAC,EAAD,CAApB,CAHlB;AAIEE,qBAAS,EAAE;AAJb,WAD4B,EAO5BP,GAP4B,EAQ5B,IAAII,UAAJ,CAAe,CAAf,CAR4B,CAAN;;;AAAlBI,yBAAe,GAAGP,SAAlB;AAUN;AAAA;AAAA,YAAOO,eAAe,CAACC,UAAhB,KAA+B,EAAtC;;;;AAEA;AAAA;AAAA,YAAO,KAAP;;;;;;;;;AAEH;;AAtBDjB","names":["subtleCryptoMethods","supportsWebCrypto","window","supportsSecureRandom","crypto","subtle","supportsSubtleCrypto","exports","getRandomValues","every","methodName","supportsZeroByteGCM","generateKey","name","length","key","_b","encrypt","iv","Uint8Array","Array","additionalData","tagLength","zeroByteAuthTag","byteLength"],"sources":["/home/dalienst/node_modules/@aws-amplify/notifications/node_modules/@aws-crypto/supports-web-crypto/src/supportsWebCrypto.ts"],"sourcesContent":["type SubtleCryptoMethod =\n  | \"decrypt\"\n  | \"digest\"\n  | \"encrypt\"\n  | \"exportKey\"\n  | \"generateKey\"\n  | \"importKey\"\n  | \"sign\"\n  | \"verify\";\n\nconst subtleCryptoMethods: Array<SubtleCryptoMethod> = [\n  \"decrypt\",\n  \"digest\",\n  \"encrypt\",\n  \"exportKey\",\n  \"generateKey\",\n  \"importKey\",\n  \"sign\",\n  \"verify\"\n];\n\nexport function supportsWebCrypto(window: Window): boolean {\n  if (\n    supportsSecureRandom(window) &&\n    typeof window.crypto.subtle === \"object\"\n  ) {\n    const { subtle } = window.crypto;\n\n    return supportsSubtleCrypto(subtle);\n  }\n\n  return false;\n}\n\nexport function supportsSecureRandom(window: Window): boolean {\n  if (typeof window === \"object\" && typeof window.crypto === \"object\") {\n    const { getRandomValues } = window.crypto;\n\n    return typeof getRandomValues === \"function\";\n  }\n\n  return false;\n}\n\nexport function supportsSubtleCrypto(subtle: SubtleCrypto) {\n  return (\n    subtle &&\n    subtleCryptoMethods.every(\n      methodName => typeof subtle[methodName] === \"function\"\n    )\n  );\n}\n\nexport async function supportsZeroByteGCM(subtle: SubtleCrypto) {\n  if (!supportsSubtleCrypto(subtle)) return false;\n  try {\n    const key = await subtle.generateKey(\n      { name: \"AES-GCM\", length: 128 },\n      false,\n      [\"encrypt\"]\n    );\n    const zeroByteAuthTag = await subtle.encrypt(\n      {\n        name: \"AES-GCM\",\n        iv: new Uint8Array(Array(12)),\n        additionalData: new Uint8Array(Array(16)),\n        tagLength: 128\n      },\n      key,\n      new Uint8Array(0)\n    );\n    return zeroByteAuthTag.byteLength === 16;\n  } catch {\n    return false;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}