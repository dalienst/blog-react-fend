{"ast":null,"code":"import { __assign as t, __spreadArray as o, __rest as n } from \"tslib\";\nimport { createMachine as r, forwardTo as i, assign as e, spawn as a } from \"xstate\";\nimport { choose as s } from \"xstate/lib/actions\";\nimport { stopActor as c } from \"./actions.js\";\nimport { signInActor as u } from \"./actors/signIn.js\";\nimport { signOutActor as d } from \"./actors/signOut.js\";\nimport { resetPasswordActor as l } from \"./actors/resetPassword.js\";\nimport { defaultServices as g } from \"./defaultServices.js\";\nimport { createSignUpMachine as v } from \"./signUp.js\";\n\nfunction f() {\n  return r({\n    id: \"authenticator\",\n    initial: \"idle\",\n    context: {\n      user: void 0,\n      config: {},\n      services: g,\n      actorRef: void 0,\n      hasSetup: !1\n    },\n    predictableActionArguments: !0,\n    states: {\n      idle: {\n        invoke: {\n          src: \"getCurrentUser\",\n          onDone: {\n            actions: \"setUser\",\n            target: \"authenticated\"\n          },\n          onError: {\n            target: \"setup\"\n          }\n        }\n      },\n      setup: {\n        initial: \"waitConfig\",\n        states: {\n          waitConfig: {\n            on: {\n              INIT: {\n                actions: [\"configure\", \"setHasSetup\"],\n                target: \"applyConfig\"\n              }\n            }\n          },\n          applyConfig: {\n            invoke: {\n              src: \"getAmplifyConfig\",\n              onDone: {\n                actions: \"applyAmplifyConfig\",\n                target: \"goToInitialState\"\n              }\n            }\n          },\n          goToInitialState: {\n            always: [{\n              target: \"#authenticator.signUp\",\n              cond: \"isInitialStateSignUp\"\n            }, {\n              target: \"#authenticator.resetPassword\",\n              cond: \"isInitialStateResetPassword\"\n            }, {\n              target: \"#authenticator.signIn\"\n            }]\n          }\n        }\n      },\n      signIn: {\n        initial: \"spawnActor\",\n        states: {\n          spawnActor: {\n            always: {\n              actions: \"spawnSignInActor\",\n              target: \"runActor\"\n            }\n          },\n          runActor: {\n            entry: \"clearActorDoneData\",\n            exit: \"stopSignInActor\"\n          }\n        },\n        on: {\n          SIGN_UP: \"signUp\",\n          RESET_PASSWORD: \"resetPassword\",\n          \"done.invoke.signInActor\": [{\n            target: \"signUp\",\n            actions: \"setActorDoneData\",\n            cond: \"shouldRedirectToSignUp\"\n          }, {\n            target: \"resetPassword\",\n            actions: \"setActorDoneData\",\n            cond: \"shouldRedirectToResetPassword\"\n          }, {\n            target: \"authenticated\",\n            actions: \"setActorDoneData\"\n          }]\n        }\n      },\n      signUp: {\n        initial: \"spawnActor\",\n        states: {\n          spawnActor: {\n            always: {\n              actions: \"spawnSignUpActor\",\n              target: \"runActor\"\n            }\n          },\n          runActor: {\n            entry: \"clearActorDoneData\",\n            exit: \"stopSignUpActor\"\n          },\n          autoSignIn: {\n            invoke: {\n              src: \"getCurrentUser\",\n              onDone: \"#authenticator.authenticated\",\n              onError: \"#authenticator.setup.goToInitialState\"\n            }\n          }\n        },\n        on: {\n          SIGN_IN: \"signIn\",\n          \"done.invoke.signUpActor\": {\n            target: \"#authenticator.signIn\",\n            actions: \"setActorDoneData\",\n            cond: \"shouldAutoSignIn\"\n          }\n        }\n      },\n      resetPassword: {\n        initial: \"spawnActor\",\n        states: {\n          spawnActor: {\n            always: {\n              actions: \"spawnResetPasswordActor\",\n              target: \"runActor\"\n            }\n          },\n          runActor: {\n            entry: \"clearActorDoneData\",\n            exit: \"stopResetPasswordActor\"\n          }\n        },\n        on: {\n          SIGN_IN: \"signIn\",\n          \"done.invoke.resetPasswordActor\": {\n            target: \"signIn\",\n            actions: \"setActorDoneData\"\n          }\n        }\n      },\n      signOut: {\n        initial: \"spawnActor\",\n        states: {\n          spawnActor: {\n            always: {\n              actions: \"spawnSignOutActor\",\n              target: \"runActor\"\n            }\n          },\n          runActor: {\n            entry: \"clearActorDoneData\",\n            exit: [\"stopSignOutActor\", \"clearUser\"]\n          }\n        },\n        on: {\n          \"done.invoke.signOutActor\": [{\n            target: \"setup\",\n            cond: \"shouldSetup\"\n          }, {\n            target: \"setup.goToInitialState\"\n          }]\n        }\n      },\n      authenticated: {\n        initial: \"idle\",\n        states: {\n          idle: {\n            on: {\n              TOKEN_REFRESH: \"refreshUser\"\n            }\n          },\n          refreshUser: {\n            invoke: {\n              src: \"getCurrentUser\",\n              onDone: {\n                actions: \"setUser\",\n                target: \"idle\"\n              },\n              onError: {\n                target: \"#authenticator.signOut\"\n              }\n            }\n          }\n        },\n        on: {\n          SIGN_OUT: \"signOut\"\n        }\n      }\n    },\n    on: {\n      CHANGE: {\n        actions: \"forwardToActor\"\n      },\n      BLUR: {\n        actions: \"forwardToActor\"\n      },\n      SUBMIT: {\n        actions: \"forwardToActor\"\n      },\n      FEDERATED_SIGN_IN: {\n        actions: \"forwardToActor\"\n      },\n      AUTO_SIGN_IN: {\n        actions: \"forwardToActor\"\n      },\n      RESEND: {\n        actions: \"forwardToActor\"\n      },\n      SIGN_IN: {\n        actions: \"forwardToActor\"\n      },\n      SKIP: {\n        actions: \"forwardToActor\"\n      }\n    }\n  }, {\n    actions: {\n      forwardToActor: s([{\n        cond: \"hasActor\",\n        actions: i(function (t) {\n          return t.actorRef;\n        })\n      }]),\n      setUser: e({\n        user: function (t, o) {\n          return o.data;\n        }\n      }),\n      setActorDoneData: e({\n        actorDoneData: function (o, n) {\n          var r, i;\n          return {\n            authAttributes: t({}, null === (r = n.data) || void 0 === r ? void 0 : r.authAttributes),\n            intent: null === (i = n.data) || void 0 === i ? void 0 : i.intent\n          };\n        },\n        user: function (t, o) {\n          var n;\n          return null === (n = o.data) || void 0 === n ? void 0 : n.user;\n        }\n      }),\n      clearUser: e({\n        user: void 0\n      }),\n      clearActorDoneData: e({\n        actorDoneData: void 0\n      }),\n      applyAmplifyConfig: e({\n        config: function (t, n) {\n          var r,\n              i,\n              e,\n              a,\n              s,\n              c,\n              u,\n              d,\n              l,\n              g = null !== (i = null === (r = n.data.aws_cognito_username_attributes) || void 0 === r ? void 0 : r.map(function (t) {\n            return t.toLowerCase();\n          })) && void 0 !== i ? i : [],\n              v = null !== (a = null === (e = n.data.aws_cognito_verification_mechanisms) || void 0 === e ? void 0 : e.map(function (t) {\n            return t.toLowerCase();\n          })) && void 0 !== a ? a : [],\n              f = null !== (c = null === (s = n.data.aws_cognito_signup_attributes) || void 0 === s ? void 0 : s.map(function (t) {\n            return t.toLowerCase();\n          })) && void 0 !== c ? c : [],\n              A = null !== (d = null === (u = n.data.aws_cognito_social_providers) || void 0 === u ? void 0 : u.map(function (t) {\n            return t.toLowerCase();\n          })) && void 0 !== d ? d : [],\n              w = n.data.aws_cognito_password_protection_settings || {};\n          0 === g.length && g.push(\"username\");\n          var S = t.config,\n              m = S.loginMechanisms,\n              h = S.signUpAttributes,\n              D = S.socialProviders,\n              I = S.initialState;\n          return {\n            loginMechanisms: null != m ? m : g,\n            formFields: null !== (l = p(S.formFields)) && void 0 !== l ? l : {},\n            passwordSettings: w,\n            signUpAttributes: null != h ? h : Array.from(new Set(o(o([], v, !0), f, !0))),\n            socialProviders: null != D ? D : A.sort(),\n            initialState: I\n          };\n        }\n      }),\n      spawnSignInActor: e({\n        actorRef: function (t, o) {\n          var n,\n              r,\n              i,\n              e,\n              s,\n              c,\n              d = t.services,\n              l = u({\n            services: d\n          }).withContext({\n            authAttributes: null !== (r = null === (n = t.actorDoneData) || void 0 === n ? void 0 : n.authAttributes) && void 0 !== r ? r : {},\n            user: t.user,\n            intent: null === (i = t.actorDoneData) || void 0 === i ? void 0 : i.intent,\n            country_code: \"+1\",\n            formValues: {},\n            touched: {},\n            validationError: {},\n            loginMechanisms: null === (e = t.config) || void 0 === e ? void 0 : e.loginMechanisms,\n            socialProviders: null === (s = t.config) || void 0 === s ? void 0 : s.socialProviders,\n            formFields: null === (c = t.config) || void 0 === c ? void 0 : c.formFields\n          });\n          return a(l, {\n            name: \"signInActor\"\n          });\n        }\n      }),\n      spawnSignUpActor: e({\n        actorRef: function (t, o) {\n          var n,\n              r,\n              i,\n              e,\n              s,\n              c,\n              u,\n              d = t.services,\n              l = v({\n            services: d\n          }).withContext({\n            authAttributes: null !== (r = null === (n = t.actorDoneData) || void 0 === n ? void 0 : n.authAttributes) && void 0 !== r ? r : {},\n            country_code: \"+1\",\n            intent: null === (i = t.actorDoneData) || void 0 === i ? void 0 : i.intent,\n            formValues: {},\n            touched: {},\n            validationError: {},\n            loginMechanisms: null === (e = t.config) || void 0 === e ? void 0 : e.loginMechanisms,\n            socialProviders: null === (s = t.config) || void 0 === s ? void 0 : s.socialProviders,\n            formFields: null === (c = t.config) || void 0 === c ? void 0 : c.formFields,\n            passwordSettings: null === (u = t.config) || void 0 === u ? void 0 : u.passwordSettings\n          });\n          return a(l, {\n            name: \"signUpActor\"\n          });\n        }\n      }),\n      spawnResetPasswordActor: e({\n        actorRef: function (t, o) {\n          var n,\n              r,\n              i,\n              e,\n              s = t.services,\n              c = l({\n            services: s\n          }).withContext({\n            formValues: {},\n            touched: {},\n            intent: null === (n = t.actorDoneData) || void 0 === n ? void 0 : n.intent,\n            username: null === (i = null === (r = t.actorDoneData) || void 0 === r ? void 0 : r.authAttributes) || void 0 === i ? void 0 : i.username,\n            formFields: null === (e = t.config) || void 0 === e ? void 0 : e.formFields,\n            validationError: {}\n          });\n          return a(c, {\n            name: \"resetPasswordActor\"\n          });\n        }\n      }),\n      spawnSignOutActor: e({\n        actorRef: function (t) {\n          var o = d.withContext({\n            user: t.user\n          });\n          return a(o, {\n            name: \"signOutActor\"\n          });\n        }\n      }),\n      stopSignInActor: c(\"signInActor\"),\n      stopSignUpActor: c(\"signUpActor\"),\n      stopResetPasswordActor: c(\"resetPasswordActor\"),\n      stopSignOutActor: c(\"signOutActor\"),\n      configure: e(function (o, r) {\n        var i = r.data,\n            e = i.services,\n            a = n(i, [\"services\"]);\n        return {\n          services: t(t({}, g), e),\n          config: a\n        };\n      }),\n      setHasSetup: e({\n        hasSetup: !0\n      })\n    },\n    guards: {\n      isInitialStateSignUp: function (t) {\n        return \"signUp\" === t.config.initialState;\n      },\n      isInitialStateResetPassword: function (t) {\n        return \"resetPassword\" === t.config.initialState;\n      },\n      shouldRedirectToSignUp: function (t, o) {\n        var n;\n        return \"confirmSignUp\" === (null === (n = o.data) || void 0 === n ? void 0 : n.intent);\n      },\n      shouldRedirectToResetPassword: function (t, o) {\n        var n;\n        return \"confirmPasswordReset\" === (null === (n = o.data) || void 0 === n ? void 0 : n.intent);\n      },\n      shouldAutoSignIn: function (t, o) {\n        var n, r;\n        return \"autoSignIn\" === (null === (n = o.data) || void 0 === n ? void 0 : n.intent) || \"autoSignInSubmit\" === (null === (r = o.data) || void 0 === r ? void 0 : r.intent);\n      },\n      shouldSetup: function (t) {\n        return !1 === t.hasSetup;\n      },\n      hasActor: function (t) {\n        return !!t.actorRef;\n      }\n    },\n    services: {\n      getCurrentUser: function (t, o) {\n        return t.services.getCurrentUser();\n      },\n      getAmplifyConfig: function (t, o) {\n        return t.services.getAmplifyConfig();\n      }\n    }\n  });\n}\n\nfunction p(t) {\n  return t && Object.keys(t).forEach(function (o) {\n    Object.keys(t[o]).forEach(function (n) {\n      var r = t[o][n];\n      r.required = r.isRequired;\n    });\n  }), t;\n}\n\nexport { f as createAuthenticatorMachine };","map":{"version":3,"sources":["/home/dalienst/node_modules/@aws-amplify/ui/dist/esm/machines/authenticator/index.js"],"names":["__assign","t","__spreadArray","o","__rest","n","createMachine","r","forwardTo","i","assign","e","spawn","a","choose","s","stopActor","c","signInActor","u","signOutActor","d","resetPasswordActor","l","defaultServices","g","createSignUpMachine","v","f","id","initial","context","user","config","services","actorRef","hasSetup","predictableActionArguments","states","idle","invoke","src","onDone","actions","target","onError","setup","waitConfig","on","INIT","applyConfig","goToInitialState","always","cond","signIn","spawnActor","runActor","entry","exit","SIGN_UP","RESET_PASSWORD","signUp","autoSignIn","SIGN_IN","resetPassword","signOut","authenticated","TOKEN_REFRESH","refreshUser","SIGN_OUT","CHANGE","BLUR","SUBMIT","FEDERATED_SIGN_IN","AUTO_SIGN_IN","RESEND","SKIP","forwardToActor","setUser","data","setActorDoneData","actorDoneData","authAttributes","intent","clearUser","clearActorDoneData","applyAmplifyConfig","aws_cognito_username_attributes","map","toLowerCase","aws_cognito_verification_mechanisms","aws_cognito_signup_attributes","A","aws_cognito_social_providers","w","aws_cognito_password_protection_settings","length","push","S","m","loginMechanisms","h","signUpAttributes","D","socialProviders","I","initialState","formFields","p","passwordSettings","Array","from","Set","sort","spawnSignInActor","withContext","country_code","formValues","touched","validationError","name","spawnSignUpActor","spawnResetPasswordActor","username","spawnSignOutActor","stopSignInActor","stopSignUpActor","stopResetPasswordActor","stopSignOutActor","configure","setHasSetup","guards","isInitialStateSignUp","isInitialStateResetPassword","shouldRedirectToSignUp","shouldRedirectToResetPassword","shouldAutoSignIn","shouldSetup","hasActor","getCurrentUser","getAmplifyConfig","Object","keys","forEach","required","isRequired","createAuthenticatorMachine"],"mappings":"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","sourcesContent":["import{__assign as t,__spreadArray as o,__rest as n}from\"tslib\";import{createMachine as r,forwardTo as i,assign as e,spawn as a}from\"xstate\";import{choose as s}from\"xstate/lib/actions\";import{stopActor as c}from\"./actions.js\";import{signInActor as u}from\"./actors/signIn.js\";import{signOutActor as d}from\"./actors/signOut.js\";import{resetPasswordActor as l}from\"./actors/resetPassword.js\";import{defaultServices as g}from\"./defaultServices.js\";import{createSignUpMachine as v}from\"./signUp.js\";function f(){return r({id:\"authenticator\",initial:\"idle\",context:{user:void 0,config:{},services:g,actorRef:void 0,hasSetup:!1},predictableActionArguments:!0,states:{idle:{invoke:{src:\"getCurrentUser\",onDone:{actions:\"setUser\",target:\"authenticated\"},onError:{target:\"setup\"}}},setup:{initial:\"waitConfig\",states:{waitConfig:{on:{INIT:{actions:[\"configure\",\"setHasSetup\"],target:\"applyConfig\"}}},applyConfig:{invoke:{src:\"getAmplifyConfig\",onDone:{actions:\"applyAmplifyConfig\",target:\"goToInitialState\"}}},goToInitialState:{always:[{target:\"#authenticator.signUp\",cond:\"isInitialStateSignUp\"},{target:\"#authenticator.resetPassword\",cond:\"isInitialStateResetPassword\"},{target:\"#authenticator.signIn\"}]}}},signIn:{initial:\"spawnActor\",states:{spawnActor:{always:{actions:\"spawnSignInActor\",target:\"runActor\"}},runActor:{entry:\"clearActorDoneData\",exit:\"stopSignInActor\"}},on:{SIGN_UP:\"signUp\",RESET_PASSWORD:\"resetPassword\",\"done.invoke.signInActor\":[{target:\"signUp\",actions:\"setActorDoneData\",cond:\"shouldRedirectToSignUp\"},{target:\"resetPassword\",actions:\"setActorDoneData\",cond:\"shouldRedirectToResetPassword\"},{target:\"authenticated\",actions:\"setActorDoneData\"}]}},signUp:{initial:\"spawnActor\",states:{spawnActor:{always:{actions:\"spawnSignUpActor\",target:\"runActor\"}},runActor:{entry:\"clearActorDoneData\",exit:\"stopSignUpActor\"},autoSignIn:{invoke:{src:\"getCurrentUser\",onDone:\"#authenticator.authenticated\",onError:\"#authenticator.setup.goToInitialState\"}}},on:{SIGN_IN:\"signIn\",\"done.invoke.signUpActor\":{target:\"#authenticator.signIn\",actions:\"setActorDoneData\",cond:\"shouldAutoSignIn\"}}},resetPassword:{initial:\"spawnActor\",states:{spawnActor:{always:{actions:\"spawnResetPasswordActor\",target:\"runActor\"}},runActor:{entry:\"clearActorDoneData\",exit:\"stopResetPasswordActor\"}},on:{SIGN_IN:\"signIn\",\"done.invoke.resetPasswordActor\":{target:\"signIn\",actions:\"setActorDoneData\"}}},signOut:{initial:\"spawnActor\",states:{spawnActor:{always:{actions:\"spawnSignOutActor\",target:\"runActor\"}},runActor:{entry:\"clearActorDoneData\",exit:[\"stopSignOutActor\",\"clearUser\"]}},on:{\"done.invoke.signOutActor\":[{target:\"setup\",cond:\"shouldSetup\"},{target:\"setup.goToInitialState\"}]}},authenticated:{initial:\"idle\",states:{idle:{on:{TOKEN_REFRESH:\"refreshUser\"}},refreshUser:{invoke:{src:\"getCurrentUser\",onDone:{actions:\"setUser\",target:\"idle\"},onError:{target:\"#authenticator.signOut\"}}}},on:{SIGN_OUT:\"signOut\"}}},on:{CHANGE:{actions:\"forwardToActor\"},BLUR:{actions:\"forwardToActor\"},SUBMIT:{actions:\"forwardToActor\"},FEDERATED_SIGN_IN:{actions:\"forwardToActor\"},AUTO_SIGN_IN:{actions:\"forwardToActor\"},RESEND:{actions:\"forwardToActor\"},SIGN_IN:{actions:\"forwardToActor\"},SKIP:{actions:\"forwardToActor\"}}},{actions:{forwardToActor:s([{cond:\"hasActor\",actions:i((function(t){return t.actorRef}))}]),setUser:e({user:function(t,o){return o.data}}),setActorDoneData:e({actorDoneData:function(o,n){var r,i;return{authAttributes:t({},null===(r=n.data)||void 0===r?void 0:r.authAttributes),intent:null===(i=n.data)||void 0===i?void 0:i.intent}},user:function(t,o){var n;return null===(n=o.data)||void 0===n?void 0:n.user}}),clearUser:e({user:void 0}),clearActorDoneData:e({actorDoneData:void 0}),applyAmplifyConfig:e({config:function(t,n){var r,i,e,a,s,c,u,d,l,g=null!==(i=null===(r=n.data.aws_cognito_username_attributes)||void 0===r?void 0:r.map((function(t){return t.toLowerCase()})))&&void 0!==i?i:[],v=null!==(a=null===(e=n.data.aws_cognito_verification_mechanisms)||void 0===e?void 0:e.map((function(t){return t.toLowerCase()})))&&void 0!==a?a:[],f=null!==(c=null===(s=n.data.aws_cognito_signup_attributes)||void 0===s?void 0:s.map((function(t){return t.toLowerCase()})))&&void 0!==c?c:[],A=null!==(d=null===(u=n.data.aws_cognito_social_providers)||void 0===u?void 0:u.map((function(t){return t.toLowerCase()})))&&void 0!==d?d:[],w=n.data.aws_cognito_password_protection_settings||{};0===g.length&&g.push(\"username\");var S=t.config,m=S.loginMechanisms,h=S.signUpAttributes,D=S.socialProviders,I=S.initialState;return{loginMechanisms:null!=m?m:g,formFields:null!==(l=p(S.formFields))&&void 0!==l?l:{},passwordSettings:w,signUpAttributes:null!=h?h:Array.from(new Set(o(o([],v,!0),f,!0))),socialProviders:null!=D?D:A.sort(),initialState:I}}}),spawnSignInActor:e({actorRef:function(t,o){var n,r,i,e,s,c,d=t.services,l=u({services:d}).withContext({authAttributes:null!==(r=null===(n=t.actorDoneData)||void 0===n?void 0:n.authAttributes)&&void 0!==r?r:{},user:t.user,intent:null===(i=t.actorDoneData)||void 0===i?void 0:i.intent,country_code:\"+1\",formValues:{},touched:{},validationError:{},loginMechanisms:null===(e=t.config)||void 0===e?void 0:e.loginMechanisms,socialProviders:null===(s=t.config)||void 0===s?void 0:s.socialProviders,formFields:null===(c=t.config)||void 0===c?void 0:c.formFields});return a(l,{name:\"signInActor\"})}}),spawnSignUpActor:e({actorRef:function(t,o){var n,r,i,e,s,c,u,d=t.services,l=v({services:d}).withContext({authAttributes:null!==(r=null===(n=t.actorDoneData)||void 0===n?void 0:n.authAttributes)&&void 0!==r?r:{},country_code:\"+1\",intent:null===(i=t.actorDoneData)||void 0===i?void 0:i.intent,formValues:{},touched:{},validationError:{},loginMechanisms:null===(e=t.config)||void 0===e?void 0:e.loginMechanisms,socialProviders:null===(s=t.config)||void 0===s?void 0:s.socialProviders,formFields:null===(c=t.config)||void 0===c?void 0:c.formFields,passwordSettings:null===(u=t.config)||void 0===u?void 0:u.passwordSettings});return a(l,{name:\"signUpActor\"})}}),spawnResetPasswordActor:e({actorRef:function(t,o){var n,r,i,e,s=t.services,c=l({services:s}).withContext({formValues:{},touched:{},intent:null===(n=t.actorDoneData)||void 0===n?void 0:n.intent,username:null===(i=null===(r=t.actorDoneData)||void 0===r?void 0:r.authAttributes)||void 0===i?void 0:i.username,formFields:null===(e=t.config)||void 0===e?void 0:e.formFields,validationError:{}});return a(c,{name:\"resetPasswordActor\"})}}),spawnSignOutActor:e({actorRef:function(t){var o=d.withContext({user:t.user});return a(o,{name:\"signOutActor\"})}}),stopSignInActor:c(\"signInActor\"),stopSignUpActor:c(\"signUpActor\"),stopResetPasswordActor:c(\"resetPasswordActor\"),stopSignOutActor:c(\"signOutActor\"),configure:e((function(o,r){var i=r.data,e=i.services,a=n(i,[\"services\"]);return{services:t(t({},g),e),config:a}})),setHasSetup:e({hasSetup:!0})},guards:{isInitialStateSignUp:function(t){return\"signUp\"===t.config.initialState},isInitialStateResetPassword:function(t){return\"resetPassword\"===t.config.initialState},shouldRedirectToSignUp:function(t,o){var n;return\"confirmSignUp\"===(null===(n=o.data)||void 0===n?void 0:n.intent)},shouldRedirectToResetPassword:function(t,o){var n;return\"confirmPasswordReset\"===(null===(n=o.data)||void 0===n?void 0:n.intent)},shouldAutoSignIn:function(t,o){var n,r;return\"autoSignIn\"===(null===(n=o.data)||void 0===n?void 0:n.intent)||\"autoSignInSubmit\"===(null===(r=o.data)||void 0===r?void 0:r.intent)},shouldSetup:function(t){return!1===t.hasSetup},hasActor:function(t){return!!t.actorRef}},services:{getCurrentUser:function(t,o){return t.services.getCurrentUser()},getAmplifyConfig:function(t,o){return t.services.getAmplifyConfig()}}})}function p(t){return t&&Object.keys(t).forEach((function(o){Object.keys(t[o]).forEach((function(n){var r=t[o][n];r.required=r.isRequired}))})),t}export{f as createAuthenticatorMachine};\n"]},"metadata":{},"sourceType":"module"}