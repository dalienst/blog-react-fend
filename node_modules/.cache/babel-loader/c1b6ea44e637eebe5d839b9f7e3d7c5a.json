{"ast":null,"code":"/* global document */\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { useEffect, useMemo, useRef, useContext } from 'react';\nimport { applyReactStyle } from '../utils/apply-react-style';\nimport { MapContext } from './map';\nimport { arePointsEqual } from '../utils/deep-equal';\nconst defaultProps = {\n  draggable: false,\n  popup: null,\n  rotation: 0,\n  rotationAlignment: 'auto',\n  pitchAlignment: 'auto'\n};\n/* eslint-disable complexity,max-statements */\n\nfunction Marker(props) {\n  const {\n    map,\n    mapLib\n  } = useContext(MapContext);\n  const thisRef = useRef({\n    props\n  });\n  thisRef.current.props = props;\n  const marker = useMemo(() => {\n    let hasChildren = false;\n    React.Children.forEach(props.children, el => {\n      if (el) {\n        hasChildren = true;\n      }\n    });\n    const options = { ...props,\n      element: hasChildren ? document.createElement('div') : null\n    };\n    const mk = new mapLib.Marker(options).setLngLat([props.longitude, props.latitude]);\n    mk.getElement().addEventListener('click', e => {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, {\n        type: 'click',\n        target: mk,\n        originalEvent: e\n      });\n    });\n    mk.on('dragstart', e => {\n      var _a, _b;\n\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('drag', e => {\n      var _a, _b;\n\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDrag) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('dragend', e => {\n      var _a, _b;\n\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    return mk;\n  }, []);\n  useEffect(() => {\n    marker.addTo(map.getMap());\n    return () => {\n      marker.remove();\n    };\n  }, []);\n  useEffect(() => {\n    applyReactStyle(marker.getElement(), props.style);\n  }, [props.style]);\n\n  if (marker.getLngLat().lng !== props.longitude || marker.getLngLat().lat !== props.latitude) {\n    marker.setLngLat([props.longitude, props.latitude]);\n  }\n\n  if (props.offset && !arePointsEqual(marker.getOffset(), props.offset)) {\n    marker.setOffset(props.offset);\n  }\n\n  if (marker.isDraggable() !== props.draggable) {\n    marker.setDraggable(props.draggable);\n  }\n\n  if (marker.getRotation() !== props.rotation) {\n    marker.setRotation(props.rotation);\n  }\n\n  if (marker.getRotationAlignment() !== props.rotationAlignment) {\n    marker.setRotationAlignment(props.rotationAlignment);\n  }\n\n  if (marker.getPitchAlignment() !== props.pitchAlignment) {\n    marker.setPitchAlignment(props.pitchAlignment);\n  }\n\n  if (marker.getPopup() !== props.popup) {\n    marker.setPopup(props.popup);\n  }\n\n  return createPortal(props.children, marker.getElement());\n}\n\nMarker.defaultProps = defaultProps; // @ts-ignore\n\nexport default React.memo(Marker);","map":{"version":3,"mappings":"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","names":["React","createPortal","useEffect","useMemo","useRef","useContext","applyReactStyle","MapContext","arePointsEqual","defaultProps","draggable","popup","rotation","rotationAlignment","pitchAlignment","Marker","props","map","mapLib","thisRef","current","marker","hasChildren","Children","forEach","children","el","options","element","document","createElement","mk","setLngLat","longitude","latitude","getElement","addEventListener","e","onClick","_b","type","target","originalEvent","on","evt","lngLat","getLngLat","onDragStart","onDrag","onDragEnd","addTo","getMap","remove","style","lng","lat","offset","getOffset","setOffset","isDraggable","setDraggable","getRotation","setRotation","getRotationAlignment","setRotationAlignment","getPitchAlignment","setPitchAlignment","getPopup","setPopup","memo"],"sources":["/home/dalienst/node_modules/react-map-gl/src/components/marker.ts"],"sourcesContent":["/* global document */\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\nimport {useEffect, useMemo, useRef, useContext} from 'react';\nimport {applyReactStyle} from '../utils/apply-react-style';\n\nimport type {\n  MarkerDragEvent,\n  MapboxPopup,\n  PointLike,\n  Anchor,\n  Alignment,\n  MapboxEvent,\n  MapboxMarker\n} from '../types';\n\nimport {MapContext} from './map';\nimport {arePointsEqual} from '../utils/deep-equal';\n\nexport type MarkerProps = {\n  /** Longitude of the anchor location */\n  longitude: number;\n  /** Latitude of the anchor location */\n  latitude: number;\n  /** A string indicating the part of the Marker that should be positioned closest to the coordinate set via Marker.setLngLat.\n   * Options are `'center'`, `'top'`, `'bottom'`, `'left'`, `'right'`, `'top-left'`, `'top-right'`, `'bottom-left'`, and `'bottom-right'`.\n   * @default \"center\"\n   */\n  anchor?: Anchor;\n  /**\n   * The max number of pixels a user can shift the mouse pointer during a click on the marker for it to be considered a valid click\n   * (as opposed to a marker drag). The default (0) is to inherit map's clickTolerance.\n   */\n  clickTolerance?: number;\n  /** The color to use for the default marker if options.element is not provided.\n   * @default \"#3FB1CE\"\n   */\n  color?: string;\n  /** A boolean indicating whether or not a marker is able to be dragged to a new position on the map.\n   * @default false\n   */\n  draggable?: boolean;\n  /** The offset in pixels as a PointLike object to apply relative to the element's center. Negatives indicate left and up. */\n  offset?: PointLike;\n  /** `map` aligns the `Marker` to the plane of the map.\n   * `viewport` aligns the `Marker` to the plane of the viewport.\n   * `auto` automatically matches the value of `rotationAlignment`.\n   * @default \"auto\"\n   */\n  pitchAlignment?: Alignment;\n  /** The rotation angle of the marker in degrees, relative to its `rotationAlignment` setting. A positive value will rotate the marker clockwise.\n   * @default 0\n   */\n  rotation?: number;\n  /** `map` aligns the `Marker`'s rotation relative to the map, maintaining a bearing as the map rotates.\n   * `viewport` aligns the `Marker`'s rotation relative to the viewport, agnostic to map rotations.\n   * `auto` is equivalent to `viewport`.\n   * @default \"auto\"\n   */\n  rotationAlignment?: Alignment;\n  /** The scale to use for the default marker if options.element is not provided.\n   * The default scale (1) corresponds to a height of `41px` and a width of `27px`.\n   * @default 1\n   */\n  scale?: number;\n  /** A Popup instance that is bound to the marker */\n  popup?: MapboxPopup;\n  /** CSS style override, applied to the control's container */\n  style?: React.CSSProperties;\n  onClick?: (e: MapboxEvent<MouseEvent>) => void;\n  onDragStart?: (e: MarkerDragEvent) => void;\n  onDrag?: (e: MarkerDragEvent) => void;\n  onDragEnd?: (e: MarkerDragEvent) => void;\n  children?: React.ReactNode;\n};\n\nconst defaultProps: Partial<MarkerProps> = {\n  draggable: false,\n  popup: null,\n  rotation: 0,\n  rotationAlignment: 'auto',\n  pitchAlignment: 'auto'\n};\n\n/* eslint-disable complexity,max-statements */\nfunction Marker(props: MarkerProps) {\n  const {map, mapLib} = useContext(MapContext);\n  const thisRef = useRef({props});\n  thisRef.current.props = props;\n\n  const marker: MapboxMarker = useMemo(() => {\n    let hasChildren = false;\n    React.Children.forEach(props.children, el => {\n      if (el) {\n        hasChildren = true;\n      }\n    });\n    const options = {\n      ...props,\n      element: hasChildren ? document.createElement('div') : null\n    };\n\n    const mk = new mapLib.Marker(options).setLngLat([props.longitude, props.latitude]);\n\n    mk.getElement().addEventListener('click', (e: MouseEvent) => {\n      thisRef.current.props.onClick?.({\n        type: 'click',\n        target: mk,\n        originalEvent: e\n      });\n    });\n\n    mk.on('dragstart', e => {\n      const evt = e as MarkerDragEvent;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDragStart?.(evt);\n    });\n    mk.on('drag', e => {\n      const evt = e as MarkerDragEvent;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDrag?.(evt);\n    });\n    mk.on('dragend', e => {\n      const evt = e as MarkerDragEvent;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDragEnd?.(evt);\n    });\n\n    return mk;\n  }, []);\n\n  useEffect(() => {\n    marker.addTo(map.getMap());\n\n    return () => {\n      marker.remove();\n    };\n  }, []);\n\n  useEffect(() => {\n    applyReactStyle(marker.getElement(), props.style);\n  }, [props.style]);\n\n  if (marker.getLngLat().lng !== props.longitude || marker.getLngLat().lat !== props.latitude) {\n    marker.setLngLat([props.longitude, props.latitude]);\n  }\n  if (props.offset && !arePointsEqual(marker.getOffset(), props.offset)) {\n    marker.setOffset(props.offset);\n  }\n  if (marker.isDraggable() !== props.draggable) {\n    marker.setDraggable(props.draggable);\n  }\n  if (marker.getRotation() !== props.rotation) {\n    marker.setRotation(props.rotation);\n  }\n  if (marker.getRotationAlignment() !== props.rotationAlignment) {\n    marker.setRotationAlignment(props.rotationAlignment);\n  }\n  if (marker.getPitchAlignment() !== props.pitchAlignment) {\n    marker.setPitchAlignment(props.pitchAlignment);\n  }\n  if (marker.getPopup() !== props.popup) {\n    marker.setPopup(props.popup);\n  }\n\n  return createPortal(props.children, marker.getElement());\n}\n\nMarker.defaultProps = defaultProps;\n\n// @ts-ignore\nexport default React.memo(Marker);\n"]},"metadata":{},"sourceType":"module"}