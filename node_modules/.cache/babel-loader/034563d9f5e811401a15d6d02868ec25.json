{"ast":null,"code":"'use strict'; // TODO: use call-bind, is-date, is-regex, is-string, is-boolean-object, is-number-object\n\nfunction toS(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nfunction isDate(obj) {\n  return toS(obj) === '[object Date]';\n}\n\nfunction isRegExp(obj) {\n  return toS(obj) === '[object RegExp]';\n}\n\nfunction isError(obj) {\n  return toS(obj) === '[object Error]';\n}\n\nfunction isBoolean(obj) {\n  return toS(obj) === '[object Boolean]';\n}\n\nfunction isNumber(obj) {\n  return toS(obj) === '[object Number]';\n}\n\nfunction isString(obj) {\n  return toS(obj) === '[object String]';\n} // TODO: use isarray\n\n\nvar isArray = Array.isArray || function isArray(xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n}; // TODO: use for-each?\n\n\nfunction forEach(xs, fn) {\n  if (xs.forEach) {\n    return xs.forEach(fn);\n  }\n\n  for (var i = 0; i < xs.length; i++) {\n    fn(xs[i], i, xs);\n  }\n\n  return void undefined;\n} // TODO: use object-keys\n\n\nvar objectKeys = Object.keys || function keys(obj) {\n  var res = [];\n\n  for (var key in obj) {\n    res.push(key);\n  } // eslint-disable-line no-restricted-syntax\n\n\n  return res;\n}; // TODO: use object.hasown\n\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty || function (obj, key) {\n  return key in obj;\n};\n\nfunction copy(src) {\n  if (typeof src === 'object' && src !== null) {\n    var dst;\n\n    if (isArray(src)) {\n      dst = [];\n    } else if (isDate(src)) {\n      dst = new Date(src.getTime ? src.getTime() : src);\n    } else if (isRegExp(src)) {\n      dst = new RegExp(src);\n    } else if (isError(src)) {\n      dst = {\n        message: src.message\n      };\n    } else if (isBoolean(src) || isNumber(src) || isString(src)) {\n      dst = Object(src);\n    } else if (Object.create && Object.getPrototypeOf) {\n      dst = Object.create(Object.getPrototypeOf(src));\n    } else if (src.constructor === Object) {\n      dst = {};\n    } else {\n      var proto = src.constructor && src.constructor.prototype || src.__proto__ || {};\n\n      var T = function T() {}; // eslint-disable-line func-style, func-name-matching\n\n\n      T.prototype = proto;\n      dst = new T();\n    }\n\n    forEach(objectKeys(src), function (key) {\n      dst[key] = src[key];\n    });\n    return dst;\n  }\n\n  return src;\n}\n\nfunction walk(root, cb, immutable) {\n  var path = [];\n  var parents = [];\n  var alive = true;\n  return function walker(node_) {\n    var node = immutable ? copy(node_) : node_;\n    var modifiers = {};\n    var keepGoing = true;\n    var state = {\n      node: node,\n      node_: node_,\n      path: [].concat(path),\n      parent: parents[parents.length - 1],\n      parents: parents,\n      key: path[path.length - 1],\n      isRoot: path.length === 0,\n      level: path.length,\n      circular: null,\n      update: function (x, stopHere) {\n        if (!state.isRoot) {\n          state.parent.node[state.key] = x;\n        }\n\n        state.node = x;\n\n        if (stopHere) {\n          keepGoing = false;\n        }\n      },\n      delete: function (stopHere) {\n        delete state.parent.node[state.key];\n\n        if (stopHere) {\n          keepGoing = false;\n        }\n      },\n      remove: function (stopHere) {\n        if (isArray(state.parent.node)) {\n          state.parent.node.splice(state.key, 1);\n        } else {\n          delete state.parent.node[state.key];\n        }\n\n        if (stopHere) {\n          keepGoing = false;\n        }\n      },\n      keys: null,\n      before: function (f) {\n        modifiers.before = f;\n      },\n      after: function (f) {\n        modifiers.after = f;\n      },\n      pre: function (f) {\n        modifiers.pre = f;\n      },\n      post: function (f) {\n        modifiers.post = f;\n      },\n      stop: function () {\n        alive = false;\n      },\n      block: function () {\n        keepGoing = false;\n      }\n    };\n\n    if (!alive) {\n      return state;\n    }\n\n    function updateState() {\n      if (typeof state.node === 'object' && state.node !== null) {\n        if (!state.keys || state.node_ !== state.node) {\n          state.keys = objectKeys(state.node);\n        }\n\n        state.isLeaf = state.keys.length === 0;\n\n        for (var i = 0; i < parents.length; i++) {\n          if (parents[i].node_ === node_) {\n            state.circular = parents[i];\n            break; // eslint-disable-line no-restricted-syntax\n          }\n        }\n      } else {\n        state.isLeaf = true;\n        state.keys = null;\n      }\n\n      state.notLeaf = !state.isLeaf;\n      state.notRoot = !state.isRoot;\n    }\n\n    updateState(); // use return values to update if defined\n\n    var ret = cb.call(state, state.node);\n\n    if (ret !== undefined && state.update) {\n      state.update(ret);\n    }\n\n    if (modifiers.before) {\n      modifiers.before.call(state, state.node);\n    }\n\n    if (!keepGoing) {\n      return state;\n    }\n\n    if (typeof state.node === 'object' && state.node !== null && !state.circular) {\n      parents.push(state);\n      updateState();\n      forEach(state.keys, function (key, i) {\n        path.push(key);\n\n        if (modifiers.pre) {\n          modifiers.pre.call(state, state.node[key], key);\n        }\n\n        var child = walker(state.node[key]);\n\n        if (immutable && hasOwnProperty.call(state.node, key)) {\n          state.node[key] = child.node;\n        }\n\n        child.isLast = i === state.keys.length - 1;\n        child.isFirst = i === 0;\n\n        if (modifiers.post) {\n          modifiers.post.call(state, child);\n        }\n\n        path.pop();\n      });\n      parents.pop();\n    }\n\n    if (modifiers.after) {\n      modifiers.after.call(state, state.node);\n    }\n\n    return state;\n  }(root).node;\n}\n\nfunction Traverse(obj) {\n  this.value = obj;\n}\n\nTraverse.prototype.get = function (ps) {\n  var node = this.value;\n\n  for (var i = 0; i < ps.length; i++) {\n    var key = ps[i];\n\n    if (!node || !hasOwnProperty.call(node, key)) {\n      return void undefined;\n    }\n\n    node = node[key];\n  }\n\n  return node;\n};\n\nTraverse.prototype.has = function (ps) {\n  var node = this.value;\n\n  for (var i = 0; i < ps.length; i++) {\n    var key = ps[i];\n\n    if (!node || !hasOwnProperty.call(node, key)) {\n      return false;\n    }\n\n    node = node[key];\n  }\n\n  return true;\n};\n\nTraverse.prototype.set = function (ps, value) {\n  var node = this.value;\n\n  for (var i = 0; i < ps.length - 1; i++) {\n    var key = ps[i];\n\n    if (!hasOwnProperty.call(node, key)) {\n      node[key] = {};\n    }\n\n    node = node[key];\n  }\n\n  node[ps[i]] = value;\n  return value;\n};\n\nTraverse.prototype.map = function (cb) {\n  return walk(this.value, cb, true);\n};\n\nTraverse.prototype.forEach = function (cb) {\n  this.value = walk(this.value, cb, false);\n  return this.value;\n};\n\nTraverse.prototype.reduce = function (cb, init) {\n  var skip = arguments.length === 1;\n  var acc = skip ? this.value : init;\n  this.forEach(function (x) {\n    if (!this.isRoot || !skip) {\n      acc = cb.call(this, acc, x);\n    }\n  });\n  return acc;\n};\n\nTraverse.prototype.paths = function () {\n  var acc = [];\n  this.forEach(function () {\n    acc.push(this.path);\n  });\n  return acc;\n};\n\nTraverse.prototype.nodes = function () {\n  var acc = [];\n  this.forEach(function () {\n    acc.push(this.node);\n  });\n  return acc;\n};\n\nTraverse.prototype.clone = function () {\n  var parents = [];\n  var nodes = [];\n  return function clone(src) {\n    for (var i = 0; i < parents.length; i++) {\n      if (parents[i] === src) {\n        return nodes[i];\n      }\n    }\n\n    if (typeof src === 'object' && src !== null) {\n      var dst = copy(src);\n      parents.push(src);\n      nodes.push(dst);\n      forEach(objectKeys(src), function (key) {\n        dst[key] = clone(src[key]);\n      });\n      parents.pop();\n      nodes.pop();\n      return dst;\n    }\n\n    return src;\n  }(this.value);\n};\n\nfunction traverse(obj) {\n  return new Traverse(obj);\n} // TODO: replace with object.assign?\n\n\nforEach(objectKeys(Traverse.prototype), function (key) {\n  traverse[key] = function (obj) {\n    var args = [].slice.call(arguments, 1);\n    var t = new Traverse(obj);\n    return t[key].apply(t, args);\n  };\n});\nmodule.exports = traverse;","map":{"version":3,"sources":["/home/dalienst/node_modules/traverse/index.js"],"names":["toS","obj","Object","prototype","toString","call","isDate","isRegExp","isError","isBoolean","isNumber","isString","isArray","Array","xs","forEach","fn","i","length","undefined","objectKeys","keys","res","key","push","hasOwnProperty","copy","src","dst","Date","getTime","RegExp","message","create","getPrototypeOf","constructor","proto","__proto__","T","walk","root","cb","immutable","path","parents","alive","walker","node_","node","modifiers","keepGoing","state","concat","parent","isRoot","level","circular","update","x","stopHere","delete","remove","splice","before","f","after","pre","post","stop","block","updateState","isLeaf","notLeaf","notRoot","ret","child","isLast","isFirst","pop","Traverse","value","get","ps","has","set","map","reduce","init","skip","arguments","acc","paths","nodes","clone","traverse","args","slice","t","apply","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\n// TODO: use call-bind, is-date, is-regex, is-string, is-boolean-object, is-number-object\nfunction toS(obj) { return Object.prototype.toString.call(obj); }\nfunction isDate(obj) { return toS(obj) === '[object Date]'; }\nfunction isRegExp(obj) { return toS(obj) === '[object RegExp]'; }\nfunction isError(obj) { return toS(obj) === '[object Error]'; }\nfunction isBoolean(obj) { return toS(obj) === '[object Boolean]'; }\nfunction isNumber(obj) { return toS(obj) === '[object Number]'; }\nfunction isString(obj) { return toS(obj) === '[object String]'; }\n\n// TODO: use isarray\nvar isArray = Array.isArray || function isArray(xs) {\n\treturn Object.prototype.toString.call(xs) === '[object Array]';\n};\n\n// TODO: use for-each?\nfunction forEach(xs, fn) {\n\tif (xs.forEach) { return xs.forEach(fn); }\n\tfor (var i = 0; i < xs.length; i++) {\n\t\tfn(xs[i], i, xs);\n\t}\n\treturn void undefined;\n}\n\n// TODO: use object-keys\nvar objectKeys = Object.keys || function keys(obj) {\n\tvar res = [];\n\tfor (var key in obj) { res.push(key); } // eslint-disable-line no-restricted-syntax\n\treturn res;\n};\n\n// TODO: use object.hasown\nvar hasOwnProperty = Object.prototype.hasOwnProperty || function (obj, key) {\n\treturn key in obj;\n};\n\nfunction copy(src) {\n\tif (typeof src === 'object' && src !== null) {\n\t\tvar dst;\n\n\t\tif (isArray(src)) {\n\t\t\tdst = [];\n\t\t} else if (isDate(src)) {\n\t\t\tdst = new Date(src.getTime ? src.getTime() : src);\n\t\t} else if (isRegExp(src)) {\n\t\t\tdst = new RegExp(src);\n\t\t} else if (isError(src)) {\n\t\t\tdst = { message: src.message };\n\t\t} else if (isBoolean(src) || isNumber(src) || isString(src)) {\n\t\t\tdst = Object(src);\n\t\t} else if (Object.create && Object.getPrototypeOf) {\n\t\t\tdst = Object.create(Object.getPrototypeOf(src));\n\t\t} else if (src.constructor === Object) {\n\t\t\tdst = {};\n\t\t} else {\n\t\t\tvar proto = (src.constructor && src.constructor.prototype)\n                || src.__proto__\n                || {};\n\t\t\tvar T = function T() {}; // eslint-disable-line func-style, func-name-matching\n\t\t\tT.prototype = proto;\n\t\t\tdst = new T();\n\t\t}\n\n\t\tforEach(objectKeys(src), function (key) {\n\t\t\tdst[key] = src[key];\n\t\t});\n\t\treturn dst;\n\t}\n\treturn src;\n}\n\nfunction walk(root, cb, immutable) {\n\tvar path = [];\n\tvar parents = [];\n\tvar alive = true;\n\n\treturn (function walker(node_) {\n\t\tvar node = immutable ? copy(node_) : node_;\n\t\tvar modifiers = {};\n\n\t\tvar keepGoing = true;\n\n\t\tvar state = {\n\t\t\tnode: node,\n\t\t\tnode_: node_,\n\t\t\tpath: [].concat(path),\n\t\t\tparent: parents[parents.length - 1],\n\t\t\tparents: parents,\n\t\t\tkey: path[path.length - 1],\n\t\t\tisRoot: path.length === 0,\n\t\t\tlevel: path.length,\n\t\t\tcircular: null,\n\t\t\tupdate: function (x, stopHere) {\n\t\t\t\tif (!state.isRoot) {\n\t\t\t\t\tstate.parent.node[state.key] = x;\n\t\t\t\t}\n\t\t\t\tstate.node = x;\n\t\t\t\tif (stopHere) { keepGoing = false; }\n\t\t\t},\n\t\t\tdelete: function (stopHere) {\n\t\t\t\tdelete state.parent.node[state.key];\n\t\t\t\tif (stopHere) { keepGoing = false; }\n\t\t\t},\n\t\t\tremove: function (stopHere) {\n\t\t\t\tif (isArray(state.parent.node)) {\n\t\t\t\t\tstate.parent.node.splice(state.key, 1);\n\t\t\t\t} else {\n\t\t\t\t\tdelete state.parent.node[state.key];\n\t\t\t\t}\n\t\t\t\tif (stopHere) { keepGoing = false; }\n\t\t\t},\n\t\t\tkeys: null,\n\t\t\tbefore: function (f) { modifiers.before = f; },\n\t\t\tafter: function (f) { modifiers.after = f; },\n\t\t\tpre: function (f) { modifiers.pre = f; },\n\t\t\tpost: function (f) { modifiers.post = f; },\n\t\t\tstop: function () { alive = false; },\n\t\t\tblock: function () { keepGoing = false; },\n\t\t};\n\n\t\tif (!alive) { return state; }\n\n\t\tfunction updateState() {\n\t\t\tif (typeof state.node === 'object' && state.node !== null) {\n\t\t\t\tif (!state.keys || state.node_ !== state.node) {\n\t\t\t\t\tstate.keys = objectKeys(state.node);\n\t\t\t\t}\n\n\t\t\t\tstate.isLeaf = state.keys.length === 0;\n\n\t\t\t\tfor (var i = 0; i < parents.length; i++) {\n\t\t\t\t\tif (parents[i].node_ === node_) {\n\t\t\t\t\t\tstate.circular = parents[i];\n\t\t\t\t\t\tbreak; // eslint-disable-line no-restricted-syntax\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstate.isLeaf = true;\n\t\t\t\tstate.keys = null;\n\t\t\t}\n\n\t\t\tstate.notLeaf = !state.isLeaf;\n\t\t\tstate.notRoot = !state.isRoot;\n\t\t}\n\n\t\tupdateState();\n\n\t\t// use return values to update if defined\n\t\tvar ret = cb.call(state, state.node);\n\t\tif (ret !== undefined && state.update) { state.update(ret); }\n\n\t\tif (modifiers.before) { modifiers.before.call(state, state.node); }\n\n\t\tif (!keepGoing) { return state; }\n\n\t\tif (\n\t\t\ttypeof state.node === 'object'\n\t\t\t&& state.node !== null\n\t\t\t&& !state.circular\n\t\t) {\n\t\t\tparents.push(state);\n\n\t\t\tupdateState();\n\n\t\t\tforEach(state.keys, function (key, i) {\n\t\t\t\tpath.push(key);\n\n\t\t\t\tif (modifiers.pre) { modifiers.pre.call(state, state.node[key], key); }\n\n\t\t\t\tvar child = walker(state.node[key]);\n\t\t\t\tif (immutable && hasOwnProperty.call(state.node, key)) {\n\t\t\t\t\tstate.node[key] = child.node;\n\t\t\t\t}\n\n\t\t\t\tchild.isLast = i === state.keys.length - 1;\n\t\t\t\tchild.isFirst = i === 0;\n\n\t\t\t\tif (modifiers.post) { modifiers.post.call(state, child); }\n\n\t\t\t\tpath.pop();\n\t\t\t});\n\t\t\tparents.pop();\n\t\t}\n\n\t\tif (modifiers.after) { modifiers.after.call(state, state.node); }\n\n\t\treturn state;\n\t}(root)).node;\n}\n\nfunction Traverse(obj) {\n\tthis.value = obj;\n}\n\nTraverse.prototype.get = function (ps) {\n\tvar node = this.value;\n\tfor (var i = 0; i < ps.length; i++) {\n\t\tvar key = ps[i];\n\t\tif (!node || !hasOwnProperty.call(node, key)) {\n\t\t\treturn void undefined;\n\t\t}\n\t\tnode = node[key];\n\t}\n\treturn node;\n};\n\nTraverse.prototype.has = function (ps) {\n\tvar node = this.value;\n\tfor (var i = 0; i < ps.length; i++) {\n\t\tvar key = ps[i];\n\t\tif (!node || !hasOwnProperty.call(node, key)) {\n\t\t\treturn false;\n\t\t}\n\t\tnode = node[key];\n\t}\n\treturn true;\n};\n\nTraverse.prototype.set = function (ps, value) {\n\tvar node = this.value;\n\tfor (var i = 0; i < ps.length - 1; i++) {\n\t\tvar key = ps[i];\n\t\tif (!hasOwnProperty.call(node, key)) { node[key] = {}; }\n\t\tnode = node[key];\n\t}\n\tnode[ps[i]] = value;\n\treturn value;\n};\n\nTraverse.prototype.map = function (cb) {\n\treturn walk(this.value, cb, true);\n};\n\nTraverse.prototype.forEach = function (cb) {\n\tthis.value = walk(this.value, cb, false);\n\treturn this.value;\n};\n\nTraverse.prototype.reduce = function (cb, init) {\n\tvar skip = arguments.length === 1;\n\tvar acc = skip ? this.value : init;\n\tthis.forEach(function (x) {\n\t\tif (!this.isRoot || !skip) {\n\t\t\tacc = cb.call(this, acc, x);\n\t\t}\n\t});\n\treturn acc;\n};\n\nTraverse.prototype.paths = function () {\n\tvar acc = [];\n\tthis.forEach(function () {\n\t\tacc.push(this.path);\n\t});\n\treturn acc;\n};\n\nTraverse.prototype.nodes = function () {\n\tvar acc = [];\n\tthis.forEach(function () {\n\t\tacc.push(this.node);\n\t});\n\treturn acc;\n};\n\nTraverse.prototype.clone = function () {\n\tvar parents = [];\n\tvar nodes = [];\n\n\treturn (function clone(src) {\n\t\tfor (var i = 0; i < parents.length; i++) {\n\t\t\tif (parents[i] === src) {\n\t\t\t\treturn nodes[i];\n\t\t\t}\n\t\t}\n\n\t\tif (typeof src === 'object' && src !== null) {\n\t\t\tvar dst = copy(src);\n\n\t\t\tparents.push(src);\n\t\t\tnodes.push(dst);\n\n\t\t\tforEach(objectKeys(src), function (key) {\n\t\t\t\tdst[key] = clone(src[key]);\n\t\t\t});\n\n\t\t\tparents.pop();\n\t\t\tnodes.pop();\n\t\t\treturn dst;\n\t\t}\n\n\t\treturn src;\n\n\t}(this.value));\n};\n\nfunction traverse(obj) {\n\treturn new Traverse(obj);\n}\n\n// TODO: replace with object.assign?\nforEach(objectKeys(Traverse.prototype), function (key) {\n\ttraverse[key] = function (obj) {\n\t\tvar args = [].slice.call(arguments, 1);\n\t\tvar t = new Traverse(obj);\n\t\treturn t[key].apply(t, args);\n\t};\n});\n\nmodule.exports = traverse;\n"]},"metadata":{},"sourceType":"script"}